<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>損益pips計算機（EUR/GBP対応）</title>
    <style>
        /* 全体的に余白を削り、コンパクトに構成 */
        body { font-family: sans-serif; padding: 10px; background: #f0f4f8; margin: 0; }
        .box { background: white; padding: 15px 20px; border-radius: 12px; max-width: 380px; margin: auto; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h2 { text-align: center; margin: 0 0 15px 0; color: #2c3e50; font-size: 20px; }
        .type-select-group { margin-bottom: 15px; } 
        .formula { background: #e3f2fd; padding: 8px; font-size: 11px; text-align: center; font-weight: bold; border-radius: 6px; color: #1976d2; border: 1px solid #bbdefb; min-height: 1.2em; }
        label { display: block; margin-top: 10px; font-weight: bold; font-size: 13px; color: #444; }
        input, select { width: 100%; padding: 8px; margin-top: 3px; box-sizing: border-box; border: 1px solid #ccc; border-radius: 6px; font-size: 15px; }
        .live-preview { font-size: 11px; color: #666; margin-top: 2px; text-align: right; min-height: 13px; }
        .result-area { margin-top: 15px; padding: 12px; background: #fff3e0; border: 2px solid #ffb74d; border-radius: 10px; text-align: center; }
        #resultValue { font-size: 30px; font-weight: bold; color: #e65100; }
        .res-label { font-size: 13px; color: #e65100; margin-bottom: 2px; }
        .note { font-size: 11px; color: #999; text-align: center; margin-top: 10px; line-height: 1.4; }
        
        /* ボタンエリアの調整（hrを消し、余白を縮小） */
        .link-container { text-align: center; margin-top: 15px; }
        .btn-link {
            display: inline-block; 
            padding: 10px 30px; 
            background-color: #ffb74d; 
            color: white; 
            text-decoration: none; 
            border-radius: 25px; 
            font-weight: bold; 
            font-size: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        .btn-link:hover { transform: scale(1.02); }
    </style>
</head>
<body>

<div class="box">
    <h2>損益pips計算機</h2>

    <div class="type-select-group">
        <label>計算タイプ</label>
        <select id="type" onchange="changeType()">
            <option value="jpy">クロス円 (USD/JPY等)</option>
            <option value="usd">ドルストレート (EUR/USD等)</option>
            <option value="eurgbp">ユーロポンド (EUR/GBP)</option>
        </select>
    </div>

    <div class="formula" id="formula">式：許容損益額 ÷ (取引数量 × 0.01)</div>

    <label>許容損益額 (円)</label>
    <input type="number" id="amount" value="5000" oninput="run()">
    <div id="amountPreview" class="live-preview">5,000 円</div>

    <label>取引数量 (通貨)</label>
    <input type="number" id="qty" value="10000" oninput="run()">
    <div id="qtyPreview" class="live-preview">10,000 通貨</div>

    <div id="rateBox" style="display:none;">
        <label id="rateLabel">現在のドル円レート (円)</label>
        <input type="number" id="baseRate" value="150.00" step="0.01" oninput="run()">
    </div>

    <div class="result-area">
        <div class="res-label">算出された損益幅</div>
        <span id="resultValue">50</span> <span style="font-size:18px; font-weight:bold; color:#e65100;">pips</span>
    </div>
    
    <div class="note" id="pipsNote">
        ※ クロス円：1pips = 0.01円
    </div>

    <div class="link-container">
        <a href="profit-calc.html" class="btn-link">損益額計算機はこちらへ</a>
    </div>
</div>

<script>
function changeType() {
    const type = document.getElementById('type').value;
    const formula = document.getElementById('formula');
    const rateBox = document.getElementById('rateBox');
    const rateLabel = document.getElementById('rateLabel');
    const pipsNote = document.getElementById('pipsNote');
    const baseRate = document.getElementById('baseRate');

    if (type === 'eurgbp') {
        formula.innerText = "式：許容損益額 ÷ (取引数量 × 0.0001 × ポンド円レート)";
        rateLabel.innerText = "現在のポンド円レート (円)";
        rateBox.style.display = 'block';
        pipsNote.innerHTML = "※ ユーロポンド：1pips = 0.0001ポンド<br>※ 決済通貨(GBP)を円換算するためポンド円を使用";
        if(parseFloat(baseRate.value) < 180) { baseRate.value = "200.00"; }
    } else if (type === 'usd') {
        formula.innerText = "式：許容損益額 ÷ (取引数量 × 0.0001 × ドル円レート)";
        rateLabel.innerText = "現在のドル円レート (円)";
        rateBox.style.display = 'block';
        pipsNote.innerText = "※ ドルストレート：1pips = 0.0001ドル";
        if(parseFloat(baseRate.value) > 180) { baseRate.value = "150.00"; }
    } else {
        formula.innerText = "式：許容損益額 ÷ (取引数量 × 0.01)";
        rateBox.style.display = 'none';
        pipsNote.innerText = "※ クロス円：1pips = 0.01円";
    }
    run();
}

function run() {
    const type = document.getElementById('type').value;
    const amount = parseFloat(document.getElementById('amount').value) || 0;
    const qty = parseFloat(document.getElementById('qty').value) || 0;
    const baseRate = parseFloat(document.getElementById('baseRate').value) || 1;
    const resultEl = document.getElementById('resultValue');

    document.getElementById('amountPreview').innerText = amount.toLocaleString() + " 円";
    document.getElementById('qtyPreview').innerText = qty.toLocaleString() + " 通貨";

    if (qty === 0) {
        resultEl.innerText = "0";
        return;
    }

    let pips = 0;
    if (type === 'eurgbp' || type === 'usd') {
        pips = amount / (qty * 0.0001 * baseRate);
    } else {
        pips = amount / (qty * 0.01);
    }

    resultEl.innerText = Math.round(pips).toLocaleString();
}

window.onload = run;
</script>

</body>
</html>
